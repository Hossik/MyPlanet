{"ast":null,"code":"\"use strict\";\n\nvar color = require(\"./color\");\n\nvar timesInWords = require(\"./util/core/times-in-words\");\n\nvar sinonFormat = require(\"./util/core/format\");\n\nvar sinonMatch = require(\"./match\");\n\nvar jsDiff = require(\"diff\");\n\nvar push = Array.prototype.push;\n\nfunction colorSinonMatchText(matcher, calledArg, calledArgMessage) {\n  if (!matcher.test(calledArg)) {\n    matcher.message = color.red(matcher.message);\n\n    if (calledArgMessage) {\n      calledArgMessage = color.green(calledArgMessage);\n    }\n  }\n\n  return calledArgMessage + \" \" + matcher.message;\n}\n\nfunction colorDiffText(diff) {\n  var objects = diff.map(function (part) {\n    var text = part.value;\n\n    if (part.added) {\n      text = color.green(text);\n    } else if (part.removed) {\n      text = color.red(text);\n    }\n\n    if (diff.length === 2) {\n      text += \" \"; // format simple diffs\n    }\n\n    return text;\n  });\n  return objects.join(\"\");\n}\n\nmodule.exports = {\n  c: function (spyInstance) {\n    return timesInWords(spyInstance.callCount);\n  },\n  n: function (spyInstance) {\n    return spyInstance.toString();\n  },\n  D: function (spyInstance, args) {\n    var message = \"\";\n\n    for (var i = 0, l = spyInstance.callCount; i < l; ++i) {\n      // describe multiple calls\n      if (l > 1) {\n        if (i > 0) {\n          message += \"\\n\";\n        }\n\n        message += \"Call \" + (i + 1) + \":\";\n      }\n\n      var calledArgs = spyInstance.getCall(i).args;\n\n      for (var j = 0; j < calledArgs.length || j < args.length; ++j) {\n        message += \"\\n\";\n        var calledArgMessage = j < calledArgs.length ? sinonFormat(calledArgs[j]) : \"\";\n\n        if (sinonMatch.isMatcher(args[j])) {\n          message += colorSinonMatchText(args[j], calledArgs[j], calledArgMessage);\n        } else {\n          var expectedArgMessage = j < args.length ? sinonFormat(args[j]) : \"\";\n          var diff = jsDiff.diffJson(calledArgMessage, expectedArgMessage);\n          message += colorDiffText(diff);\n        }\n      }\n    }\n\n    return message;\n  },\n  C: function (spyInstance) {\n    var calls = [];\n\n    for (var i = 0, l = spyInstance.callCount; i < l; ++i) {\n      var stringifiedCall = \"    \" + spyInstance.getCall(i).toString();\n\n      if (/\\n/.test(calls[i - 1])) {\n        stringifiedCall = \"\\n\" + stringifiedCall;\n      }\n\n      push.call(calls, stringifiedCall);\n    }\n\n    return calls.length > 0 ? \"\\n\" + calls.join(\"\\n\") : \"\";\n  },\n  t: function (spyInstance) {\n    var objects = [];\n\n    for (var i = 0, l = spyInstance.callCount; i < l; ++i) {\n      push.call(objects, sinonFormat(spyInstance.thisValues[i]));\n    }\n\n    return objects.join(\", \");\n  },\n  \"*\": function (spyInstance, args) {\n    return args.map(function (arg) {\n      return sinonFormat(arg);\n    }).join(\", \");\n  }\n};","map":{"version":3,"sources":["/home/hoss/my App/my-app/node_modules/sinon/lib/sinon/spy-formatters.js"],"names":["color","require","timesInWords","sinonFormat","sinonMatch","jsDiff","push","Array","prototype","colorSinonMatchText","matcher","calledArg","calledArgMessage","test","message","red","green","colorDiffText","diff","objects","map","part","text","value","added","removed","length","join","module","exports","c","spyInstance","callCount","n","toString","D","args","i","l","calledArgs","getCall","j","isMatcher","expectedArgMessage","diffJson","C","calls","stringifiedCall","call","t","thisValues","arg"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar color = require(\"./color\");\nvar timesInWords = require(\"./util/core/times-in-words\");\nvar sinonFormat = require(\"./util/core/format\");\nvar sinonMatch = require(\"./match\");\nvar jsDiff = require(\"diff\");\nvar push = Array.prototype.push;\n\nfunction colorSinonMatchText(matcher, calledArg, calledArgMessage) {\n    if (!matcher.test(calledArg)) {\n        matcher.message = color.red(matcher.message);\n        if (calledArgMessage) {\n            calledArgMessage = color.green(calledArgMessage);\n        }\n    }\n    return calledArgMessage + \" \" + matcher.message;\n}\n\nfunction colorDiffText(diff) {\n    var objects = diff.map(function (part) {\n        var text = part.value;\n        if (part.added) {\n            text = color.green(text);\n        } else if (part.removed) {\n            text = color.red(text);\n        }\n        if (diff.length === 2) {\n            text += \" \"; // format simple diffs\n        }\n        return text;\n    });\n    return objects.join(\"\");\n}\n\nmodule.exports = {\n    c: function (spyInstance) {\n        return timesInWords(spyInstance.callCount);\n    },\n\n    n: function (spyInstance) {\n        return spyInstance.toString();\n    },\n\n    D: function (spyInstance, args) {\n        var message = \"\";\n\n        for (var i = 0, l = spyInstance.callCount; i < l; ++i) {\n            // describe multiple calls\n            if (l > 1) {\n                if (i > 0) {\n                    message += \"\\n\";\n                }\n                message += \"Call \" + (i + 1) + \":\";\n            }\n            var calledArgs = spyInstance.getCall(i).args;\n            for (var j = 0; j < calledArgs.length || j < args.length; ++j) {\n                message += \"\\n\";\n                var calledArgMessage = j < calledArgs.length ? sinonFormat(calledArgs[j]) : \"\";\n                if (sinonMatch.isMatcher(args[j])) {\n                    message += colorSinonMatchText(args[j], calledArgs[j], calledArgMessage);\n                } else {\n                    var expectedArgMessage = j < args.length ? sinonFormat(args[j]) : \"\";\n                    var diff = jsDiff.diffJson(calledArgMessage, expectedArgMessage);\n                    message += colorDiffText(diff);\n                }\n            }\n        }\n\n        return message;\n    },\n\n    C: function (spyInstance) {\n        var calls = [];\n\n        for (var i = 0, l = spyInstance.callCount; i < l; ++i) {\n            var stringifiedCall = \"    \" + spyInstance.getCall(i).toString();\n            if (/\\n/.test(calls[i - 1])) {\n                stringifiedCall = \"\\n\" + stringifiedCall;\n            }\n            push.call(calls, stringifiedCall);\n        }\n\n        return calls.length > 0 ? \"\\n\" + calls.join(\"\\n\") : \"\";\n    },\n\n    t: function (spyInstance) {\n        var objects = [];\n\n        for (var i = 0, l = spyInstance.callCount; i < l; ++i) {\n            push.call(objects, sinonFormat(spyInstance.thisValues[i]));\n        }\n\n        return objects.join(\", \");\n    },\n\n    \"*\": function (spyInstance, args) {\n        return args.map(function (arg) { return sinonFormat(arg); }).join(\", \");\n    }\n};\n"]},"metadata":{},"sourceType":"script"}