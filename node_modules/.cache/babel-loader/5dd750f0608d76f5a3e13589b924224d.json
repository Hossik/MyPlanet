{"ast":null,"code":"\"use strict\";\n\nvar fakeServer = require(\"./fake_server\");\n\nvar fakeTimers = require(\"./fake_timers\");\n\nfunction Server() {}\n\nServer.prototype = fakeServer;\nvar fakeServerWithClock = new Server();\n\nfakeServerWithClock.addRequest = function addRequest(xhr) {\n  if (xhr.async) {\n    if (typeof setTimeout.clock === \"object\") {\n      this.clock = setTimeout.clock;\n    } else {\n      this.clock = fakeTimers.useFakeTimers();\n      this.resetClock = true;\n    }\n\n    if (!this.longestTimeout) {\n      var clockSetTimeout = this.clock.setTimeout;\n      var clockSetInterval = this.clock.setInterval;\n      var server = this;\n\n      this.clock.setTimeout = function (fn, timeout) {\n        server.longestTimeout = Math.max(timeout, server.longestTimeout || 0);\n        return clockSetTimeout.apply(this, arguments);\n      };\n\n      this.clock.setInterval = function (fn, timeout) {\n        server.longestTimeout = Math.max(timeout, server.longestTimeout || 0);\n        return clockSetInterval.apply(this, arguments);\n      };\n    }\n  }\n\n  return fakeServer.addRequest.call(this, xhr);\n};\n\nfakeServerWithClock.respond = function respond() {\n  var returnVal = fakeServer.respond.apply(this, arguments);\n\n  if (this.clock) {\n    this.clock.tick(this.longestTimeout || 0);\n    this.longestTimeout = 0;\n\n    if (this.resetClock) {\n      this.clock.restore();\n      this.resetClock = false;\n    }\n  }\n\n  return returnVal;\n};\n\nfakeServerWithClock.restore = function restore() {\n  if (this.clock) {\n    this.clock.restore();\n  }\n\n  return fakeServer.restore.apply(this, arguments);\n};\n\nmodule.exports = fakeServerWithClock;","map":{"version":3,"sources":["/home/hoss/my App/my-app/node_modules/sinon/lib/sinon/util/fake_server_with_clock.js"],"names":["fakeServer","require","fakeTimers","Server","prototype","fakeServerWithClock","addRequest","xhr","async","setTimeout","clock","useFakeTimers","resetClock","longestTimeout","clockSetTimeout","clockSetInterval","setInterval","server","fn","timeout","Math","max","apply","arguments","call","respond","returnVal","tick","restore","module","exports"],"mappings":"AAAA;;AAEA,IAAIA,UAAU,GAAGC,OAAO,CAAC,eAAD,CAAxB;;AACA,IAAIC,UAAU,GAAGD,OAAO,CAAC,eAAD,CAAxB;;AAEA,SAASE,MAAT,GAAkB,CAAE;;AACpBA,MAAM,CAACC,SAAP,GAAmBJ,UAAnB;AAEA,IAAIK,mBAAmB,GAAG,IAAIF,MAAJ,EAA1B;;AAEAE,mBAAmB,CAACC,UAApB,GAAiC,SAASA,UAAT,CAAoBC,GAApB,EAAyB;AACtD,MAAIA,GAAG,CAACC,KAAR,EAAe;AACX,QAAI,OAAOC,UAAU,CAACC,KAAlB,KAA4B,QAAhC,EAA0C;AACtC,WAAKA,KAAL,GAAaD,UAAU,CAACC,KAAxB;AACH,KAFD,MAEO;AACH,WAAKA,KAAL,GAAaR,UAAU,CAACS,aAAX,EAAb;AACA,WAAKC,UAAL,GAAkB,IAAlB;AACH;;AAED,QAAI,CAAC,KAAKC,cAAV,EAA0B;AACtB,UAAIC,eAAe,GAAG,KAAKJ,KAAL,CAAWD,UAAjC;AACA,UAAIM,gBAAgB,GAAG,KAAKL,KAAL,CAAWM,WAAlC;AACA,UAAIC,MAAM,GAAG,IAAb;;AAEA,WAAKP,KAAL,CAAWD,UAAX,GAAwB,UAAUS,EAAV,EAAcC,OAAd,EAAuB;AAC3CF,QAAAA,MAAM,CAACJ,cAAP,GAAwBO,IAAI,CAACC,GAAL,CAASF,OAAT,EAAkBF,MAAM,CAACJ,cAAP,IAAyB,CAA3C,CAAxB;AAEA,eAAOC,eAAe,CAACQ,KAAhB,CAAsB,IAAtB,EAA4BC,SAA5B,CAAP;AACH,OAJD;;AAMA,WAAKb,KAAL,CAAWM,WAAX,GAAyB,UAAUE,EAAV,EAAcC,OAAd,EAAuB;AAC5CF,QAAAA,MAAM,CAACJ,cAAP,GAAwBO,IAAI,CAACC,GAAL,CAASF,OAAT,EAAkBF,MAAM,CAACJ,cAAP,IAAyB,CAA3C,CAAxB;AAEA,eAAOE,gBAAgB,CAACO,KAAjB,CAAuB,IAAvB,EAA6BC,SAA7B,CAAP;AACH,OAJD;AAKH;AACJ;;AAED,SAAOvB,UAAU,CAACM,UAAX,CAAsBkB,IAAtB,CAA2B,IAA3B,EAAiCjB,GAAjC,CAAP;AACH,CA7BD;;AA+BAF,mBAAmB,CAACoB,OAApB,GAA8B,SAASA,OAAT,GAAmB;AAC7C,MAAIC,SAAS,GAAG1B,UAAU,CAACyB,OAAX,CAAmBH,KAAnB,CAAyB,IAAzB,EAA+BC,SAA/B,CAAhB;;AAEA,MAAI,KAAKb,KAAT,EAAgB;AACZ,SAAKA,KAAL,CAAWiB,IAAX,CAAgB,KAAKd,cAAL,IAAuB,CAAvC;AACA,SAAKA,cAAL,GAAsB,CAAtB;;AAEA,QAAI,KAAKD,UAAT,EAAqB;AACjB,WAAKF,KAAL,CAAWkB,OAAX;AACA,WAAKhB,UAAL,GAAkB,KAAlB;AACH;AACJ;;AAED,SAAOc,SAAP;AACH,CAdD;;AAgBArB,mBAAmB,CAACuB,OAApB,GAA8B,SAASA,OAAT,GAAmB;AAC7C,MAAI,KAAKlB,KAAT,EAAgB;AACZ,SAAKA,KAAL,CAAWkB,OAAX;AACH;;AAED,SAAO5B,UAAU,CAAC4B,OAAX,CAAmBN,KAAnB,CAAyB,IAAzB,EAA+BC,SAA/B,CAAP;AACH,CAND;;AAQAM,MAAM,CAACC,OAAP,GAAiBzB,mBAAjB","sourcesContent":["\"use strict\";\n\nvar fakeServer = require(\"./fake_server\");\nvar fakeTimers = require(\"./fake_timers\");\n\nfunction Server() {}\nServer.prototype = fakeServer;\n\nvar fakeServerWithClock = new Server();\n\nfakeServerWithClock.addRequest = function addRequest(xhr) {\n    if (xhr.async) {\n        if (typeof setTimeout.clock === \"object\") {\n            this.clock = setTimeout.clock;\n        } else {\n            this.clock = fakeTimers.useFakeTimers();\n            this.resetClock = true;\n        }\n\n        if (!this.longestTimeout) {\n            var clockSetTimeout = this.clock.setTimeout;\n            var clockSetInterval = this.clock.setInterval;\n            var server = this;\n\n            this.clock.setTimeout = function (fn, timeout) {\n                server.longestTimeout = Math.max(timeout, server.longestTimeout || 0);\n\n                return clockSetTimeout.apply(this, arguments);\n            };\n\n            this.clock.setInterval = function (fn, timeout) {\n                server.longestTimeout = Math.max(timeout, server.longestTimeout || 0);\n\n                return clockSetInterval.apply(this, arguments);\n            };\n        }\n    }\n\n    return fakeServer.addRequest.call(this, xhr);\n};\n\nfakeServerWithClock.respond = function respond() {\n    var returnVal = fakeServer.respond.apply(this, arguments);\n\n    if (this.clock) {\n        this.clock.tick(this.longestTimeout || 0);\n        this.longestTimeout = 0;\n\n        if (this.resetClock) {\n            this.clock.restore();\n            this.resetClock = false;\n        }\n    }\n\n    return returnVal;\n};\n\nfakeServerWithClock.restore = function restore() {\n    if (this.clock) {\n        this.clock.restore();\n    }\n\n    return fakeServer.restore.apply(this, arguments);\n};\n\nmodule.exports = fakeServerWithClock;\n"]},"metadata":{},"sourceType":"script"}